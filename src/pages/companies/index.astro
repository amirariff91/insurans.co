---
import Base from '../../layouts/Base.astro';
import companies from '../../data/companies.json';

const conventional = companies.filter(c => c.type === 'conventional');
const takafulOnly = companies.filter(c => c.type === 'takaful');
const withTakaful = companies.filter(c => c.takaful);

const schema = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "Senarai Syarikat Insurans Malaysia",
  "description": "Direktori lengkap syarikat insurans dan takaful di Malaysia — review, rating, dan perbandingan.",
  "url": "https://insurans.co/companies/",
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Utama", "item": "https://insurans.co/" },
      { "@type": "ListItem", "position": 2, "name": "Syarikat", "item": "https://insurans.co/companies/" }
    ]
  }
};
---

<Base
  title="Syarikat Insurans Malaysia 2026 — Senarai & Review Lengkap"
  description="Senarai lengkap syarikat insurans dan takaful di Malaysia. Review Etiqa, Allianz, AIA, Tokio Marine, Prudential dan lain-lain. Rating, produk, dan perbandingan."
  schema={schema}
>
  <section class="bg-white border-b border-stone-200">
    <div class="container-wide py-10 sm:py-14">
      <nav class="text-sm text-stone-400 mb-5">
        <a href="/" class="hover:text-hijau-700 text-stone-500">Utama</a>
        <span class="mx-2">›</span>
        <span class="text-stone-700">Syarikat</span>
      </nav>
      <h1 class="font-serif text-headline-lg text-stone-900 mb-4">
        Syarikat Insurans di Malaysia
      </h1>
      <p class="text-lg text-stone-600 max-w-2xl leading-relaxed">
        Direktori syarikat insurans dan takaful yang beroperasi di Malaysia.
        Setiap review ditulis berdasarkan pengalaman sebenar, bukan copy-paste dari website syarikat.
      </p>

      <div class="flex flex-wrap gap-4 mt-6 text-sm text-stone-600">
        <span><strong class="text-stone-900">{companies.length}</strong> syarikat</span>
        <span>•</span>
        <span><strong class="text-stone-900">{withTakaful.length}</strong> ada takaful</span>
        <span>•</span>
        <span><strong class="text-stone-900">{takafulOnly.length}</strong> takaful sahaja</span>
      </div>
    </div>
  </section>

  <section class="container-wide py-10 sm:py-14">
    <!-- Sort info -->
    <p class="text-sm text-stone-500 mb-6">Disusun mengikut rating — tertinggi dahulu.</p>

    <!-- Company list -->
    <div class="space-y-4">
      {[...companies].sort((a, b) => b.rating - a.rating).map((company, i) => (
        <a href={`/companies/${company.slug}/`} class="card-editorial group block">
          <div class="flex flex-col sm:flex-row sm:items-start gap-4">
            <!-- Rank -->
            <div class="flex-shrink-0 font-serif text-2xl text-stone-300 w-8 hidden sm:block">
              {i + 1}.
            </div>

            <!-- Content -->
            <div class="flex-1 min-w-0">
              <div class="flex items-baseline flex-wrap gap-2 mb-1.5">
                <h2 class="font-serif text-xl text-stone-900 group-hover:text-hijau-700 transition-colors">
                  {company.name}
                </h2>
                <span class="text-xs text-stone-500">★ {company.rating}/5</span>
                {company.type === 'takaful' ? (
                  <span class="text-xs font-medium text-hijau-700 bg-hijau-50 px-2 py-0.5">Takaful</span>
                ) : company.takaful ? (
                  <span class="text-xs font-medium text-emas-700 bg-emas-50 px-2 py-0.5">Ada Takaful</span>
                ) : null}
              </div>

              <p class="text-xs text-stone-400 mb-2">
                {company.fullName}
                {company.parent && <span> · {company.parent}</span>}
              </p>

              <p class="text-sm text-stone-600 mb-3">{company.verdictBM}</p>

              <!-- Products -->
              <div class="flex flex-wrap gap-1.5 mb-3">
                {company.products.map((product: string) => (
                  <span class="text-xs bg-stone-100 text-stone-600 px-2 py-0.5">
                    {product === 'car' ? 'Kereta' :
                     product === 'motorcycle' ? 'Motosikal' :
                     product === 'health' ? 'Kesihatan' :
                     product === 'life' ? 'Nyawa' :
                     product === 'travel' ? 'Travel' :
                     product === 'home' ? 'Rumah' :
                     product === 'personal-accident' ? 'PA' : product}
                  </span>
                ))}
              </div>

              <!-- Meta -->
              <div class="flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-stone-500">
                <span>Est. {company.founded}</span>
                {company.carPremiumRange && <span>Kereta: {company.carPremiumRange}</span>}
                {company.claimLine && <span>Claim: {company.claimLine}</span>}
              </div>
            </div>
          </div>
        </a>
      ))}
    </div>
  </section>

  <!-- Quick note -->
  <section class="bg-white border-t border-stone-200 py-10">
    <div class="container-article">
      <div class="info-box">
        <p class="text-sm text-stone-700">
          <strong>Tentang rating kami:</strong> Rating berdasarkan gabungan harga, kemudahan proses online,
          kelajuan claim, dan pengalaman pelanggan. Kami tak dibayar oleh mana-mana syarikat untuk review ini.
          Kalau anda ada pengalaman berbeza, kami nak dengar.
        </p>
      </div>
    </div>
  </section>
</Base>
